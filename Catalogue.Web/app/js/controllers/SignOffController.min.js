(function(){angular.module("app.controllers").controller("SignOffController",function(n,t,i,r){var f,u;return u={openData:{summary:{},list:[]},signOffStatus:{},signOffTimeoutMap:{}},n.m=u,f=function(){return t.get("../api/publishing/pendingsignoff").success(function(n){var r,t,f,i;for(u.openData.list=n,i=[],t=0,f=n.length;t<f;t++)r=n[t],i.push(u.signOffStatus[r.id]="Sign Off");return i})},f(),n.submitSignOff=function(i){return n.signOffRequest={id:i,comment:""},t.put("../api/publishing/signoff",n.signOffRequest).success(function(){return u.signOffStatus[i]="Signed Off",n.status.refresh(),n.notifications.add("Successfully signed off")})["catch"](function(t){return t.status===401?n.notifications.add("Unauthorised - not in valid sign off group"):n.notifications.add(t.data.exceptionMessage),u.signOffStatus[i]="Retry?",delete u.signOffTimeoutMap[i]})},n.allowGraceTime=function(t){return u.signOffTimeoutMap[t]>0?(u.signOffStatus[t]="Cancel "+("0"+u.signOffTimeoutMap[t]--).slice(-2),r(n.allowGraceTime.bind(null,t),1e3)):t in u.signOffTimeoutMap?n.submitSignOff(t):void 0},n.cancelSignOff=function(n){return delete u.signOffTimeoutMap[n],u.signOffStatus[n]="Sign Off"},n.signOffButtonClick=function(t){return t in u.signOffTimeoutMap?n.cancelSignOff(t):(u.signOffTimeoutMap[t]=10,n.allowGraceTime(t))}})}).call(this);