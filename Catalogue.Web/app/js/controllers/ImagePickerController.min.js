(function(){angular.module("app.controllers").controller("ImagePickerController",function(n,t,i,r){return n.recordImage=angular.copy(r),n.images=[],n.rowsPerPage=2,n.imagesPerRow=4,n.noOfPages=0,n.currentPage=0,n.page=[],n.selectedImageUrl="",n.selectedImage={},n.getImages=function(){return t.get(i).then(function(t){return n.images=t.data,n.refreshPages()})},n.refreshPages=function(){return n.images=n.images.sort(function(n,t){return new Date(t.LastEdited)-new Date(n.LastEdited)}),n.recordImage&&(n.selectedImageUrl=n.recordImage.url),n.noOfPages=Math.ceil(n.images.length/(n.rowsPerPage*n.imagesPerRow)),n.setPage(n.currentPage)},n.setPage=function(t){var i;if(!(t<0)&&t!==n.noOfPages)return i=n.rowsPerPage*n.imagesPerRow,n.page=n.images.length<=i?n.makePageFromImages(n.images):n.makePageFromImages(n.images.slice(i*t,i*t+i)),n.currentPage=t},n.makePageFromImages=function(t){var u,f,e,i,r;if(f=[],t.length<=n.imagesPerRow)f.push(t);else for(i=Math.ceil(t.length/n.imagesPerRow),u=r=0;0<=i?r<i:r>i;u=0<=i?++r:--r)e=t.slice(u*n.imagesPerRow,u*n.imagesPerRow+n.imagesPerRow),f.push(e);return f},n.saveImage=function(t){return n.setBlankImage(),t.Url===n.selectedImageUrl?(n.recordImage.url=t.Url,n.recordImage.width=t.Width,n.recordImage.height=t.Height,n.recordImage.crops.squareUrl=t.Crops.Square,n.recordImage.crops.thumbnailUrl=t.Crops.ListingThumbnail):n.selectedImageUrl?n.recordImage.url=n.selectedImageUrl:n.recordImage=null,n.$close(n.recordImage)},n.setBlankImage=function(){return n.recordImage={url:null,height:0,width:0,crops:{squareUrl:null,thumbnailUrl:null}}},n.setSelectedImage=function(t){return n.selectedImage=t,n.selectedImageUrl=t.Url},n.getImages()})}).call(this);